@using System.Web.Optimization
@model SportsManager.Baseball.ViewModels.Controllers.PlayerClassifiedViewModel

@{
    ViewBag.Title = Model.AccountName + " Player Classified";
}

@section head {
}

<div class="jumbotron">
    @Header.DisplayHeader("Player Classified", Model.AccountName, Model.AccountLogoUrl)
</div>

<div class="container" id="playerClassifiedView">

    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="deleteModalLabel">Confirm Delete Post</h4>
                </div>
                <div class="modal-body" id="deleteModalBody">
                    You are about to delete a player classified post. You cannot undo this operation. Are you sure you want to continue?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal" id="confirmDeleteBtn">Continue</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-success col-sm-6">
        <h4>Want to try to get on a team?</h4> Click <button type="button" class="btn btn-success" data-bind="click: registerPlayer">here</button> to let us know. All the current managers in the league will be notified.
    </div>
    <div class="alert alert-info col-sm-6">
        <h4>Need players for your team or tournament?</h4>
        <!-- ko if: contactId -->
        Click <button type="button" class="btn btn-info" data-bind="click: registerTeam">here</button> so interested people can contact you!
        <!-- /ko -->
        <!-- ko ifnot: contactId -->
        <div class="alert alert-warning">
            Available to logged in users only.
        </div>
        <!-- /ko -->
    </div>

    <div class="clearfix"></div>

    <form role="form" data-bind="with: currentPlayerEdit, visible: showPlayerRegisterForm">
        <h3>Player Register</h3>
        <div class="form-group">
            <label for="pr_name" class="control-label">Name</label>
            <input id="pr_name" type="text" class="form-control" placeholder="enter your name" data-bind="value: Name" />
        </div>
        <div class="form-group">
            <label for="pr_birthdate" class="control-label">Birthdate</label>
            <input id="pr_birthdate" type="text" class="form-control" placeholder="enter you birthdate" data-bind="datepicker: BirthDate, datepickerOptions: {format: 'M dd, yyyy', autoclose: true, startView: 2 }">
        </div>
        <div class="form-group">
            <label for="pr_pos" class="control-label">Positions</label>
            <select id="pr_pos" data-bind="selectPicker: PositionsPlayed.List" class="form-control" multiple title="select positions...">
                <option>Pitcher</option>
                <option>Catcher</option>
                <option>First Base</option>
                <option>Second Base</option>
                <option>Third Base</option>
                <option>Shortstop</option>
                <option>Outfield</option>
            </select>
        </div>
        <div class="form-group">
            <label for="pr_email" class="control-label">EMail</label>
            <input id="pr_email" class="form-control" type="email" placeholder="enter email" data-bind="value: EMail" />
        </div>
        <div class="form-group">
            <label for="pr_phone" class="control-label">Phone</label>
            <input id="pr_phone" class="form-control" type="text" placeholder="enter phone number" data-bind="phoneNumber: Phone" />
        </div>
        <div class="form-group">
            <label for="pr_exp" class="control-label">Experience</label>
            <textarea id="pr_exp" class="form-control" rows="6" data-bind="value: Experience"></textarea>
        </div>
        <div class="alert alert-warning">
            Your registration information will stay on this site for @Model.DaysToKeep days. After @Model.DaysToKeep days you will have to re-register.
        </div>
        <div class="form-group">
            <button class="btn btn-success" type="button" title="register your information" data-bind="click: $root.saveRegisterPlayer"><span class="glyphicon glyphicon-ok"></span></button>
            <button class="btn btn-danger" type="button" title="cancel changes" data-bind="click: $root.cancelRegisterPlayer"><span class="glyphicon glyphicon-remove"></span></button>
        </div>
    </form>

    <!-- ko if: contact -->
    <form role="form" data-bind="with: currentTeamEdit, visible: showTeamRegisterForm">
        <h3>Looking For Players</h3>
        <img class="img-rounded" onerror="this.style.display = 'none';" data-bind="attr: { src: $root.contact().PhotoURL }" /><h4 style="display: inline-block;margin-left: 10px" data-bind="html: $root.contact().FullNameFirst"></h4>
        <div style="margin-top: 10px">
            <abbr data-toggle="tooltip" title="email">E:</abbr> <span data-bind="html: $root.contact().Email"></span>
        </div>
        <div style="margin-bottom: 10px">
            <abbr data-toggle="tooltip" title="Phone Number">P:</abbr> <span data-bind="html: $root.contact().Phone1"></span>
        </div>
        <hr />
        <div class="form-group">
            <label class="control-label">Team or Tournament</label>
            <input class="form-control" placeholder="enter team or tournament name" data-bind="value: TeamEventName"/>
        </div>
        <div class="form-group">
            <label for="tr_pos" class="control-label">Positions Needed</label>
            <select id="tr_pos" data-bind="selectPicker: PositionsNeeded.List" class="form-control" multiple title="select positions needed...">
                <option>Any</option>
                <option>Pitcher</option>
                <option>Catcher</option>
                <option>First Base</option>
                <option>Second Base</option>
                <option>Third Base</option>
                <option>Shortstop</option>
                <option>Outfield</option>
            </select>
        </div>

        <div class="form-group">
            <label for="tr_description" class="control-label">Description</label>
            <textarea rows="5" id="tr_description" class="form-control" data-bind="value: Description"></textarea>
        </div>

        <div class="alert alert-warning">
            This request will stay on this site for @Model.DaysToKeep days. After @Model.DaysToKeep days you will have to re-register.
        </div>
        <div class="form-group">
            <button class="btn btn-success" type="button" title="register your information" data-bind="click: $root.saveRegisterTeam"><span class="glyphicon glyphicon-ok"></span></button>
            <button class="btn btn-danger" type="button" title="cancel changes" data-bind="click: $root.cancelRegisterTeam"><span class="glyphicon glyphicon-remove"></span></button>
        </div>

    </form>
    <!-- /ko -->

    <div class="panel-group" id="accordion">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#teamsWanted">Teams Wanted <span class="badge pull-right"><span data-bind="html: playersLooking().length"></span></span></a>
                </h3>
            </div>
            <div class="panel-collapse collapse" id="teamsWanted">
                <div class="panel-body">
                    <!-- ko ifnot: playersLooking().length -->
                    <div class="alert alert-warning">
                        No players looking for teams.
                    </div>
                    <!-- /ko -->
                    <!-- ko if: playersLooking().length && $root.contactId == 0 -->
                    <div class="alert alert-warning">
                        You must be logged in to see contact information.
                    </div>
                    <!-- /ko -->
                    <div class="list-group" data-bind="foreach: playersLooking">
                        <div class="list-group-item">
                            <h3 class="list-group-item-heading"><span data-bind="html: Name"></span> <small><span data-bind="html: BirthDate.Age"></span> years old</small></h3>
                            <p class="list-group-item-text" data-bind="html: Experience"></p>
                            <div style="margin-top: 10px">
                                Positions Played: <span data-bind="html: PositionsPlayed"></span>
                            </div>
                            <!-- ko if: $root.contactId > 0 || CanEdit() -->
                            <div style="margin-top: 10px">
                                <abbr data-toggle="tooltip" title="email">E:</abbr> <a data-bind="attr: { href: 'mailto:' + EMail() }"><span data-bind="html: EMail"></span></a>
                            </div>
                            <div style="margin-bottom: 10px">
                                <abbr data-toggle="tooltip" title="Phone Number">P:</abbr> <span data-bind="html: Phone"></span>
                            </div>
                            <!-- /ko -->
                            @if (Model.IsAdmin)
                            {
                                <button type="button" class="btn btn-default" data-bind="click: $root.editPlayerRegistration" title="edit"><span class="glyphicon glyphicon-edit"></span></button>
                                <button type="button" class="btn btn-danger" data-bind="click: $root.deletePlayerRegistration" title="delete"><span class="glyphicon glyphicon-remove"></span></button>
                            }
                            else
                            {
                                <!-- ko if: CanEdit -->
                                <button type="button" class="btn btn-default" data-bind="click: $root.editPlayerRegistration" title="edit"><span class="glyphicon glyphicon-edit"></span></button>
                                <button type="button" class="btn btn-danger" data-bind="click: $root.deletePlayerRegistration" title="delete"><span class="glyphicon glyphicon-remove"></span></button>
                                <!-- /ko -->
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#playersWanted">Players Wanted <span class="badge pull-right"><span data-bind="html: teamsLooking().length"></span></span></a>
                </h3>
            </div>
            <div class="panel-collapse collapse" id="playersWanted">
                <div class="panel-body">
                    <!-- ko ifnot: teamsLooking().length -->
                    <div class="alert alert-warning">
                        No teams looking for players.
                    </div>
                    <!-- /ko -->
                    <div class="list-group" data-bind="foreach: teamsLooking">
                        <div class="list-group-item">
                            <h3 class="list-group-item-heading" data-bind="html: TeamEventName"></h3>
                            <img class="img-rounded" onerror="this.style.display = 'none';" data-bind="attr: { src: CreatedByPhotoUrl }" /><h4 style="display: inline-block;margin-left: 10px" data-bind="html: CreatedByName"></h4>
                            <div style="margin-top: 10px">
                                <abbr data-toggle="tooltip" title="email">E:</abbr> <a data-bind="attr: { href: 'mailto:' + EMail() }"><span data-bind="html: EMail"></span></a>
                            </div>
                            <div style="margin-bottom: 10px">
                                <abbr data-toggle="tooltip" title="Phone Number">P:</abbr> <span data-bind="html: Phone"></span>
                            </div>
                            <hr />
                            <p class="list-group-item-text" data-bind="html: Description"></p>
                            <div style="margin-top: 10px">
                                Positions Needed: <span data-bind="html: PositionsNeeded"></span>
                            </div>
                            @if (Model.IsAdmin)
                            {
                                <button type="button" class="btn btn-default" data-bind="click: $root.editTeamRegistration" title="edit"><span class="glyphicon glyphicon-edit"></span></button>
                                <button type="button" class="btn btn-danger" data-bind="click: $root.deleteTeamRegistration" title="delete"><span class="glyphicon glyphicon-remove"></span></button>
                            }
                            else
                            {
                                <!-- ko if: $root.contactId == CreatedByContactId() -->
                                <button type="button" class="btn btn-default" data-bind="click: $root.editTeamRegistration" title="edit"><span class="glyphicon glyphicon-edit"></span></button>
                                <button type="button" class="btn btn-danger" data-bind="click: $root.deleteTeamRegistration" title="delete"><span class="glyphicon glyphicon-remove"></span></button>
                                <!-- /ko -->
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {

    @Scripts.Render("~/bundles/knockout")
    <script src="@Url.Content("~/Areas/Baseball/Scripts/playerclassified.js")" type="text/javascript"></script>
    <script type="text/javascript" src="~/Scripts/jquery.maskedinput-1.3.1.min.js"></script>

    <script type="text/javascript">

        $(document).ready(function () {
            initPlayerClassifiedViewModel(@Model.AccountId, @Model.IsAdmin.ToString().ToLower(), @Model.ContactId);
        });

    </script>
}
