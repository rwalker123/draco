@model SportsManager.Baseball.ViewModels.TeamViewModel
@using System.Web.Optimization;

@{
    ViewBag.Title = Model.AccountName + " " + Model.Team.Name;
}
@section head {
    @Styles.Render("~/Content/themes/base/css")
    @Styles.Render("~/Content/font-awesome")
}
<div class="jumbotron">
    <img onerror="this.style.display = 'none';" src="@Model.Team.TeamLogoURL" class="img-rounded" style="margin-top:-35px;margin-right:20px" /><h1 style="display: inline-block;">@Model.Team.Name</h1><br />
    @if (Model.FromLeagueAccount)
    {
        <small>@Model.AccountName @Model.SeasonName season</small>
    }
</div>

<div class="container-fluid">

    <div class="row" style="margin-top:20px">
    @if (Model.IsTeamMember)
    {
        <div class="col-md-9">
            @{Html.RenderPartial("AnnouncementView", new SportsManager.ViewModels.AnnouncementsViewModel(Model.Controller, Model.AccountId, Model.Team.Id));}
            @{Html.RenderPartial("WelcomeMessageView", new SportsManager.ViewModels.WelcomeMessageViewModel(Model.Controller, Model.AccountId, Model.Team.Id));}
        </div>
    }
    
    <div class="col-md-3">
        @{Html.RenderPartial("ScoreboardView", new SportsManager.Baseball.ViewModels.ScoreboardViewModel(Model.Controller, Model.AccountId));}
    </div>

    </div>
            
    <div class="row" style="margin-top:20px">
    @if (Model.IsTeamMember)
    {
        <div class="col-md-4">
            @{Html.RenderPartial("HandoutsView", new SportsManager.ViewModels.HandoutsViewModel(Model.Controller, Model.AccountId));}
        </div>
    }

    @if (Model.ShowPhotoGallery)
    {
        <div id="photoGallery" data-bind="visible: photoGalleryVisible">
            <div class="col-md-8">
                @{Html.RenderPartial("PhotoGallery", new SportsManager.ViewModels.PhotoGalleryViewModel(Model.Controller, Model.AccountId));}
            </div>
        </div>
    }
        
    </div>

    [Team Record] <br />
    <ul>
        <li>@Html.ActionLink("Statistics", "TeamStatistics", "Index", new { id = Model.Team.Id }, null)</li>
        <li>Roster</li>
        <li><a href="javascript:onLoadPrintableRosterCard()">Printable Roster Card</a></li>
    </ul>

    <div id="currentGames">
        <h3>Schedule</h3>
        prev game next game
            ><br />
            @Html.ActionLink("Complete Team Schedule", "TeamSchedule", "Index", new { id = Model.Team.Id }, null)<br />
            <a>Game Summaries</a>
    </div>
    <div id="theSponsors">
        <h3>
            Sponsors
            @if (Model.IsAdmin)
            {
                <a>[add new]</a>
            }
        </h3>
    </div>
</div>

@section scripts
{
@Scripts.Render("~/bundles/bootstrap-wysiwyg")

<script type="text/javascript" src="~/Scripts/welcome.js"></script>
<script type="text/javascript" src="~/Scripts/announcement.js"></script>
<script type="text/javascript" src="~/Areas/Baseball/Scripts/scoreboard.js"></script>

@Scripts.Render("~/bundles/knockout")

    <!-- main javascript -->
<script type="text/javascript">

        $(document).ready(function () {
            // Ajax state is not remembered when clicking "back" button. Whenever a change is made with Ajax
            // on this page, hash is set to update. If back is pressed in that case, then reload the page.
            if (window.location.hash == '#update') {
                window.location.hash = '';
                window.location.reload();
            }

            initKOHelpers();

            welcomeData = new WelcomeClass(@Model.AccountId, @Model.IsAdmin.ToString().ToLower(), @Model.Team.Id);
            announcementData = new AnnouncementClass(@Model.AccountId, @Model.IsAdmin.ToString().ToLower(), @Model.Team.Id);
            scoreboardData = new ScoreboardClass(@Model.AccountId, @Model.IsAdmin.ToString().ToLower(), @Model.Team.Id);

            // from welcome message. If no welcome message, ShowFirstMenu doesn't exist.
            welcomeData.ShowFirstMenu();
            announcementData.AdjustNewsMenuHeaders();

            $(".selectpicker").selectpicker();
            initToolbarBootstrapBindings();
            $('.wysiwygEditor').wysiwyg();
            $('.wysiwygEditor').cleanHtml();
        });
</script>
}
